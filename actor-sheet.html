<form	class="{{cssClass}} flexcol{{#if flags.inline-secrets}} inline-secrets{{/if}}{{#if flags.hidden-secrets}} hidden-secrets{{/if}}" 
		autocomplete="off"
		style="--list-seperator: '{{ localize 'MOBLOKS5E.Comma' }}'; --list-conjuntion: '{{ localize 'MOBLOKS5E.ListFinalConjunctionAnd' }}'; "
	>
	<nav class="switches">
		<i class="fas fa-cog"></i>
		<ul>
			<li>
				<a class="trigger" data-control="switchToDefault">{{ localize "MOBLOKS5E.SwitchToDefault" }}</a>
			</li>
			<li>
				<a class="switch" data-control="attack-descriptions">{{ localize "MOBLOKS5E.AttackDescriptions" }}</a>
				<ul>
					<li>
						<a class="switch" data-control="attack-descriptions">
							{{~#if flags.attack-descriptions}}
								{{~ localize "MOBLOKS5E.HideGenerated" ~}}
							{{~else}}
								{{~ localize "MOBLOKS5E.ShowGenerated" ~}}
							{{~/if~}}
						</a>
					</li>
				</ul>
			</li>
			{{#if info.hasCastingFeature}}
			<li>
				<a class="switch" data-control="casting-feature">{{ localize "DND5E.Spellcasting" }}</a>
				<ul>
					<li>
						<a class="switch" data-control="casting-feature">
							{{~#if flags.casting-feature~}}
								{{~ localize "MOBLOKS5E.HideGenerated" ~}}
							{{~else~}}
								{{~ localize "MOBLOKS5E.ShowGenerated" ~}}
							{{~/if~}}
						</a>
					</li>
				</ul>
			</li>
			{{/if}}
			<li>
				<a>{{ localize "MOBLOKS5E.DescriptionS" }}</a>
				<ul>
					<li>
						<a class="switch" data-control="inline-secrets">
							{{~#if flags.inline-secrets~}}
								{{~ localize "MOBLOKS5E.DisableInlSecr" ~}}
							{{~else~}}
								{{~ localize "MOBLOKS5E.EnableInlSecr" ~}}
							{{~/if~}}
						</a>
					</li>
					<li>
						<a class="switch" data-control="hidden-secrets">
							{{~#if flags.hidden-secrets~}}
								{{~ localize "MOBLOKS5E.ShowSecrets" ~}}
							{{~else~}}
								{{~ localize "MOBLOKS5E.HideSecrets" ~}}
							{{~/if~}}
						</a>
					</li>
				</ul>
			</li>
			<li>
				<a>{{ localize "DND5E.HitPoints" }}</a>
				<ul>
					<li>
						<a class="switch" data-control="current-hit-points">
							{{~#if flags.current-hit-points~}}
								{{~ localize "MOBLOKS5E.HideCurrentHP" ~}}
							{{~else~}}
								{{~ localize "MOBLOKS5E.ShowCurrentHP" ~}}
							{{~/if~}}
						</a>
					</li>
					<li>
						<a class="switch" data-control="maximum-hit-points">
							{{~#if flags.maximum-hit-points~}}
								{{~ localize "MOBLOKS5E.HideMaxHP" ~}}
							{{~else~}}
								{{~ localize "MOBLOKS5E.ShowMaxHP" ~}}
							{{~/if~}}
						</a>
					</li>
				</ul>
			</li>
			<li>
				<a class="switch" data-control="hide-profile-image">
					{{~#if flags.hide-profile-image~}}
						{{ localize "MOBLOKS5E.ShowProfileImage" ~}}
					{{~else~}}
						{{ localize "MOBLOKS5E.HideProfileImage" ~}}
					{{~/if~}}
				</a>
			</li>
			{{#if info.hasLair}}
			<li>
				<a class="switch" data-control="show-lair-actions">
					{{~#if flags.show-lair-actions~}}
						{{ localize "MOBLOKS5E.HideLair" ~}}
					{{~else~}}
						{{ localize "MOBLOKS5E.ShowLair" ~}}
					{{~/if~}}
				</a>
			</li>
			{{/if}}
			<li>
				<a>{{ localize "MOBLOKS5E.Theme" }}</a>
				<ul>
				{{#each themes as |theme id|}}
				{{#unless (eq id "custom")}}
					<li>
						<a	class="trigger{{#if (eq ../flags.theme-choice id)}} selected{{/if}}"
							data-control="pickTheme" 
							data-value="{{id}}">
							{{~ localize theme.name ~}}
						</a>
					</li>
				{{/unless}}
				{{/each}}
					<li>
						<label class="custome-class-label{{#if (eq flags.theme-choice 'custom')}} selected{{/if}}">
							<a	class="trigger nochild" 
								data-control="pickTheme" 
								data-value="custom">
								{{~ localize "MOBLOKS5E.CustomThemeName" }}{{ localize "MOBLOKS5E.Colon" ~}}
							</a>
							<input type="text" class="custom-class-input" placeholder="class-name" value="{{flags.custom-theme-class}}">
						</label>
					</li>
				</ul>
			</li>
		</ul>
	</nav>	
	<header class="sheet-header{{#unless flags.hide-profile-image}} image-enabled{{/unless}}">
		<section id="monster-identity">
			<h1 class="charname" contenteditable="false" data-field-key="name">{{actor.name}}</h1>
			<p class="chartype">
				<span contenteditable="false" data-field-key="">
					{{~lookup config.actorSizes data.traits.size~}}
				</span>
				<span contenteditable="false" data-field-key="data.details.type">
					{{~data.details.type~}}
				</span>{{~" "~}}
				{{~#if data.details.alignment~}}
					<span class="sep">{{ localize "MOBLOKS5E.Comma" }}</span>
				{{/if}}
				<span contenteditable="false" data-field-key="data.details.alignment">
					{{~data.details.alignment~}}
				</span>
			</p>
			{{#unless flags.hide-profile-image}}<figure class="profile-image" style="background-image: url({{actor.img}});" title="{{actor.name}}" data-edit="img"/></figure>{{/unless}}
		</section>
		<section class="monster-attributes1">
			<ul class="attributes">
				<li class="attribute">
					<h4 class="attribute-name box-title">{{ localize "DND5E.ArmorClass" }} </h4>
					<span class="attr-value">{{data.attributes.ac.value}}</span>
				</li>
				<li class="attribute health">
					<h4 class="attribute-name box-title">{{localize "DND5E.HitPoints" }} </h4>
					{{~#unless (or flags.current-hit-points flags.maximum-hit-points)~}}
						<span title="{{ localize 'MOBLOKS5E.Average' }}" class="attr-value">{{averageroll data.attributes.hp.formula}}</span>
					{{~/unless~}}
					{{#if flags.current-hit-points}}
						<span title="{{ localize 'MOBLOKS5E.Current' }}" data-field-key="data.attributes.hp.value" class="attr-value hasinput">
						{{#if data.attributes.hp.value}}
							{{data.attributes.hp.value}}
						{{else}}
							0
						{{/if}}
						</span>
						<input title="{{ localize 'MOBLOKS5E.Current' }}" data-dtype="Number" name="data.attributes.hp.value" class="attr-value hiddeninput hidden hp-input" value="{{data.attributes.hp.value}}">
					{{~/if~}}
					{{~#if (and flags.current-hit-points flags.maximum-hit-points)~}}
						<span class="sep"> / </span>
					{{~/if~}}
					{{~#if flags.maximum-hit-points~}}
						<span title="{{ localize 'MOBLOKS5E.Maximum' }}" data-field-key="data.attributes.hp.max" class="attr-value hasinput">
						{{#if data.attributes.hp.max}}
							{{data.attributes.hp.max}}
						{{else}}
							0
						{{/if}}
						</span>
						<input title="{{ localize 'MOBLOKS5E.Maximum' }}" data-dtype="Number" name="data.attributes.hp.max" class="attr-value hiddeninput hidden hp-input" value="{{data.attributes.hp.max}}">
					{{/if}}
					
					<span class="sep">(</span><span title="Average: {{averageroll data.attributes.hp.formula}}" class="attr-value">{{data.attributes.hp.formula}}</span><span class="sep">)</span>
				</li>
				<li class="attribute">
                    <h4 class="attribute-name box-title">{{ localize "DND5E.Speed" }} </h4>
					<span class="attr-value" contenteditable="false" data-field-key="data.attributes.speed.value">{{data.attributes.speed.value}}</span>
					{{~#if data.attributes.speed.special~}}
						<span class="sep">{{ localize "MOBLOKS5E.Comma" }} </span>
						<span class="attr-value" contenteditable="false" data-field-key="data.attributes.speed.special">{{data.attributes.speed.special}}</span>
					{{~/if~}}
                </li>
			</ul>
		</section>
		<section class="monster-abilities">
			<ul class="ability-scores flexrow">
            {{#each data.abilities as |ability id|}}
                <li class="ability{{#if ability.proficient}} proficient{{/if}}" data-ability="{{id}}">
                    <h4 class="ability-name box-title" title="{{ability.label}}">{{ability.abbr}}</h4>
					<span class="attr-value" title="{{ localize 'MOBLOKS5E.Score' }}">{{ability.value}} </span>
					<span class="ability-mod" title="{{ localize 'MOBLOKS5E.Modifier' }}">({{numberFormat ability.mod decimals=0 sign=true}})</span>
                </li>
            {{/each}}
            </ul>
		</section>
		<section class="monster-attributes2">
			<ul class="attributes">
				{{#if info.hasSaveProfs}}
				<li class="monster-saves">
					<h4 class="attribute-name">{{ localize "MOBLOKS5E.SavingThrowS" }}</h4>
					<ul class="inline-list">
					{{#each data.abilities as |ability id|}}
					{{#if ability.proficient}}
						<li class="saving-throw {{#if ability.proficient}}proficient{{/if}}" data-ability="{{id}}" title="{{ability.label}}">
							<span class="ability-name">{{ability.abbr}}</span>
							<span class="ability-save">{{numberFormat ability.save decimals=0 sign=true}}</span>{{~" "~}}
						</li>
					{{/if}}
					{{/each}}
					</ul>
				</li>
				{{/if}}
				{{#if info.hasSkills}}
				<li class="monster-skills">
					<h4 class="attribute-name">{{ localize "MOBLOKS5E.SkillS" }}</h4>
					<ul class="inline-list">
					{{#each data.skills as |skill s|}}
					{{#if skill.value}}
						<li class="skill {{#if skill.value}}proficient{{/if}}"  title="{{skill.ability}}" data-skill="{{s}}">
							<span class="skill-name">{{skill.label}}</span>
							<span class="skill-mod">{{numberFormat skill.total decimals=0 sign=true}}</span>{{~" "~}}
						</li>
					{{/if}}
					{{/each}}
					</ul>
				</li>
				{{/if}}
				{{#if (moblok-hascontents data.traits.dv.selected)}}
				<li class="attribute">
					<h4 class="attribute-name">{{localize "DND5E.DamVuln"}}</h4>
					<ul class="traits-list inline-list">
					{{#each data.traits.dv.selected as |v k|}}
						<li class="trait-value">{{v}}</li>
					{{/each}}
					</ul>
				</li>
				{{/if}}
				{{#if (moblok-hascontents data.traits.dr.selected)}}
				<li class="attribute">
					<h4 class="attribute-name">{{localize "DND5E.DamRes"}}</h4>
					<ul class="traits-list inline-list">
					{{#each data.traits.dr.selected as |v k|}}
						<li class="trait-value">{{v}}</li>
					{{/each}}
					</ul>
				</li>
				{{/if}}
				{{#if (moblok-hascontents data.traits.di.selected)}}
				<li class="attribute">
					<h4 class="attribute-name">{{localize "DND5E.DamImm"}}</h4>
					<ul class="traits-list inline-list">
					{{#each data.traits.di.selected as |v k|}}
						<li class="trait-value">{{v}}</li>
					{{/each}}
					</ul>
				</li>
				{{/if}}
				{{#if (moblok-hascontents data.traits.ci.selected)}}
				<li class="attribute">
					<h4 class="attribute-name">{{localize "DND5E.ConImm"}}</h4>
					<ul class="traits-list inline-list">
					{{#each data.traits.ci.selected as |v k|}}
						<li class="trait-value">{{v}}</li>
					{{/each}}
					</ul>
				</li>
				{{/if}}
				<li class="attribute">
					<h4 class="attribute-name">{{localize "DND5E.Senses"}}</h4>
					<span class="trait-value">{{data.traits.senses}}</span>
				</li>
				
				<li class="attribute">
					<h4 class="attribute-name">{{localize "DND5E.Languages"}}</h4>
					<ul class="traits-list inline-list">
					{{#if (moblok-hascontents data.traits.languages.selected)}}
						{{#each data.traits.languages.selected as |v k|}}
							<li class="trait-value">{{v}}</li>
						{{/each}}
					{{else}}
						<li class="trait-value">&mdash;</li>
					{{/if}}
					</ul>
				</li>
				
				<li class="attribute">
					<h4 class="attribute-name">{{localize "DND5E.ChallengeRating"}}</h4>
					<span class="trait-value">{{labels.cr}}</span> <span>({{ localize "MOBLOKS5E.XPLabel" xp=data.details.xp.label }})</span>
				</li>
			</ul>
		</section>
    </header>
	{{#*inline "featureBlock"}}
	<section class="item monster-feature{{#if legendaryactions}} legendary-actions{{/if}}{{#if lairactions}} lair-actions{{/if}}">
		<div class="feature-description inline-children">
			{{#unless lairactions}}
				<span class="item-name" data-item-id="{{item._id}}">
					{{~item.name~}} 
				</span>
				
				{{~#if item.data.recharge.value~}}
					<span class="name-extension" 
						data-roll-flavor="{{item.name}} ({{ localize 'MOBLOKS5E.Recharge' }} {{item.data.recharge.value}}-6): " 
						data-roll-formula="1d6" 
						data-roll-target="{{item.data.recharge.value}}" 
						data-roll-success="{{ localize 'DND5E.Charged' }}" 
						data-roll-failure="{{ localize 'MOBLOKS5E.NCharged' }}">
						({{ localize 'MOBLOKS5E.Recharge' }} {{item.data.recharge.value}}-6){{~" "~}}
					</span>
				{{~/if~}}
				{{~#if (and item.is.legendary (gt item.data.activation.cost 1))~}}
					<span class="name-extension">
						({{ localize "MOBLOKS5E.LegActionCost" number=item.data.activation.cost}}){{~" "~}}
					</span>
				{{~/if~}}
				{{~#unless legendaryactions~}}
					{{~#if item.hasResource~}}
						<span class="name-extension">
							({{~getresourcelimit item actor}}/{{getresourcerefresh item actor~}}){{~" "~}}
						</span>
					{{~/if~}}
				{{~/unless~}}{{ localize "MOBLOKS5E.NameDescriptionSep" }}
			{{~else~}}
				<span class="item-name" data-item-id="{{item._id}}"></span>
			{{~/unless}}
			<span class="description">{{{moblok-enrichhtml item.data.description.value}}}</span>
		</div>
	</section>
	{{/inline}}
	
	{{#each features.casting.items as |casting id|}}
	<section class="monster-feature spellcasting-trait">
		<div class="feature-description inline-children">
			<span class="feature-name">{{localize "DND5E.Spellcasting"}}</span>.
			<span class="description">
				{{{ casting.description.level }}}
				{{{ casting.description.ability }}}
				{{{ casting.description.stats }}}
				{{{ casting.description.warlockRecharge }}}
				{{{ casting.description.spellintro }}}
			</span>
			<ul class="spell-list">
			{{#each casting.spellbook as |page id|}}
				<li>
					<span class="spell-level-name">
						{{page.label~}}
					</span>
					{{~#if page.slotLabel}}
						<span class="spell-slots">({{page.slotLabel}})</span>
					{{~/if~}}
					{{~ localize "MOBLOKS5E.Colon" }}
					<ul class="inline-list spells-level-{{spelllevel.dataset.level}}">
					{{#each page.spells as |spell id|}}
							<li class="spell" data-item-id="{{spell._id}}">
								<span class="spell-name">{{spell.name}}</span>{{~" "~}}
							</li>
					{{/each}}
					</ul>
				</li>
			{{/each}}
			</ul>
		</div>
	</section>
	{{/each}}
	
	{{#each features.features.items as |item iid|}}
		{{#unless item.is.specialAction}}
			{{> featureBlock item=item actor=../actor}}
		{{/unless}}
	{{/each}}
	{{#if features.legResist.items}}
		{{> featureBlock item=features.legResist.items.[0] actor=actor}}
	{{/if}}
	<h2 class="section-header" >{{localize "DND5E.ActionPl"}}</h2>
	{{#if features.multiattack.items}}
		{{> featureBlock item=features.multiattack.items.[0] actor=actor}}
	{{/if}}
	{{#each features.attacks.items as |item iid|}}
	{{#unless item.is.specialAction}}
	<section class="item monster-action">
		<div class="attack-description inline-children">
			<span class="item-name" data-item-id="{{item._id}}">{{item.name}}</span>{{ localize "MOBLOKS5E.NameDescriptionSep" }}
			{{#if ../flags.attack-descriptions}}
			{{~#unless legendaryactions~}}
				{{~#if item.hasResource~}} 
					<span class="name-extension">
						({{~getresourcelimit item ../actor}}/{{getresourcerefresh item ../actor~}})
					</span>
				{{~/if~}}
			{{~/unless}}
			<span class="generated-text">			
				<span class="attack-bonus" 
					data-roll-flavor="{{localize 'DND5E.Attack'}}: {{item.name}}" 
					data-roll-formula="1d20 + {{item.tohit}}">
					<span class="attack-type">
						{{~localize item.description.attackType~}}
					</span>
					{{ localize "MOBLOKS5E.Colon" }}
					{{item.description.tohit~}}
				</span>{{ localize "MOBLOKS5E.Comma" }}
				<span>
					{{ item.description.range }}{{ localize "MOBLOKS5E.Comma" }}
					{{ item.description.target }}{{ localize "MOBLOKS5E.FullStop" }}
				</span>
				{{#if item.description.damage }}
				<span class="attack-damage" 
					data-roll-flavor="{{localize 'DND5E.Damage'}}: {{item.name}}" 
					data-roll-formula="{{item.description.damageFormula}}">
					<span class="hit-label">
						{{ localize "MOBLOKS5E.AttackHitLabel" }}
					</span>
					<span>{{ item.description.damage }}</span>
					{{ localize "MOBLOKS5E.damage" }}{{ localize "MOBLOKS5E.FullStop" }}
				</span>
				{{/if}}
			</span>
			{{/if}}
			<span class="description">{{{moblok-enrichhtml item.data.description.value}}}</span>
		</div>
	</section>
	{{/unless}}
	{{/each}}
	{{#each features.actions.items as |item iid|}}
		{{#unless item.is.specialAction}}
			{{> featureBlock item=item actor=../actor}}
		{{/unless}}
	{{/each}}
	{{! Reactions }}
	{{#if info.hasReactions}}
		<h2 class="section-header">{{localize "MOBLOKS5E.Reactions"}}</h2>
		{{#each features.reaction.items as |item iid|}}
			{{#if item.is.reaction}}
				{{> featureBlock item=item actor=../actor}}
			{{/if}}
		{{/each}}
	{{/if}}
	{{! Legendary Actions }}
	{{#if info.hasLegendaryActions}}
		<h2 class="section-header">{{localize "DND5E.LegAct"}}</h2>
		<p class="legendary-description">
			{{ localize "MOBLOKS5E.LegendaryText" name=actor.name }}
		</p>
		{{#each features.legendary.items as |item iid|}}
			{{#if item.is.legendary }}
			{{#unless item.is.legResist}}
				{{> featureBlock item=item actor=../actor legendaryactions=true}}
			{{/unless}}
			{{/if}}
		{{/each}}
	{{/if}}
	{{! Lair Actions }}
	{{#if info.hasLair}}
	{{#if flags.show-lair-actions}}
		<h2 class="section-header">{{ localize "MOBLOKS5E.LairActionsHeading" }}</h2>
		<p>{{ localize "MOBLOKS5E.LairText" name=actor.name }}</p>
		<ul>
		{{#each features.lair.items as |item iid|}}
			{{#if item.is.lair}}
			<li>
				{{> featureBlock item=item actor=../actor lairactions=true}}
			</li>
			{{/if}}
		{{/each}}
		</ul>
	{{/if}}
	{{/if}}
</form>